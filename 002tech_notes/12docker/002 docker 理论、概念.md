# docker 理论、概念
## 1 联合文件系统UnionFS
UnionFS(联合文件系统)：Union文件系统(UnionFS)是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union文件系统是Docker镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。
![[attachments/image.png]]

## 2 docker 镜像加载原理
docker 实际上是一层一层的文件系统组成，这种层级的文件系统就是 UnionFS。
docker 镜像的最底层是引导文件系统bootfs。主要包含bootloader和kernel。bootloader用于引导加载kernel。

### 2.1 镜像分层的好处：
1.  方便复用
2.  方便复制迁移

### 2.2 镜像与容器
docker镜像层都是**只读的**，容器层是**可写的**
![[attachments/image-1.png]]
  

## 3 容器数据卷
![[attachments/image 1.png]]

卷就是目录或文件，存在于一个或多个容器中，由docker挂载到容器，但不属于联合文件系统，因此能够绕过UnionFS提供一些用于持续存储或共享数据的特性：

卷的设计目的就是数据的持久化，完全独立于容器的生存周期。因此**Docker不会在容器删除时删除其挂载的数据卷**。

#### 3.1.1 特点：

- [[#docker 理论、概念|docker 理论、概念]]
	- [[#1 联合文件系统UnionFS|1 联合文件系统UnionFS]]
	- [[#2 docker 镜像加载原理|2 docker 镜像加载原理]]
		- [[#2.1 镜像分层的好处：|2.1 镜像分层的好处：]]
		- [[#2.2 镜像与容器|2.2 镜像与容器]]
	- [[#3 容器数据卷|3 容器数据卷]]
			- [[#3.1.1 特点：^toc|3.1.1 特点：]]
1.  数据卷可以在容器间共享、重用数据。
2.  卷中的更改实时生效。
3.  数据卷中的更改不会包含在镜像更新中。
4.  数据卷的生命周期一直持续到没有容器使用它为止。