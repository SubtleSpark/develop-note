# MySQL事务简介

## 什么是事务
事务是一组原子性的SQL语句，或者说是一个独立的工作单元。事务内的语句要么全部执行成功，要么全部执行失败。

## 事务的特性（ACID）

### 原子性（Atomicity）
- 事务是一个不可分割的工作单位
- 事务中的操作要么全部成功，要么全部失败回滚
- 不存在部分完成的事务

### 一致性（Consistency）
- 事务必须使数据库从一个一致性状态变换到另一个一致性状态
- 数据库的完整性约束没有被破坏

### 隔离性（Isolation）
- 一个事务的执行不能被其他事务干扰
- 并发执行的各个事务之间不能互相影响

### 持久性（Durability）
- 一旦事务提交，则其所做的修改就会永久保存在数据库中
- 即使系统崩溃，修改的数据也不会丢失

## 事务的状态

1. **活动的（active）**
   - 事务对应的数据库操作正在执行过程中

2. **部分提交的（partially committed）**
   - 最后一个操作执行完，但数据还在内存中，尚未写入磁盘

3. **失败的（failed）**
   - 当事务在执行过程中遇到错误，无法继续执行

4. **中止的（aborted）**
   - 事务执行失败后，回滚到事务开始前的状态

5. **提交的（committed）**
   - 事务中的所有操作都成功执行，并且数据已经写入磁盘

## 隐式提交的情况
以下情况会导致事务的隐式提交：

1. 定义或修改数据库对象的数据定义语言（DDL）
2. 隐式使用或修改mysql数据库中的表
3. 事务控制或关于锁定的语句
4. 加载数据的语句
5. 关于MySQL复制的一些语句
6. 其它管理语句

## 保存点（Savepoint）
- 用于事务内部的回滚点
- 可以回滚到指定的保存点，而不是整个事务

```sql
### 创建保存点
SAVEPOINT 保存点名称

### 回滚到保存点
ROLLBACK TO SAVEPOINT 保存点名称

### 删除保存点
RELEASE SAVEPOINT 保存点名称
```
